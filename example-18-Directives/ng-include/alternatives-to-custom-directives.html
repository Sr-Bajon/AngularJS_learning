<!--
  Tenemos dos directivas, ng-include y ng-switch que nos pueden ayudar a
   extraer HTML en pequeñas partes y decidir cuando mostrarlas o no en nuestro
   HTML.

   ng-include
    Toma una expresión y la trata como una ruta a un archivo HTML.
    Pide ese HTML al servidor e incluye su contenido en el elemento que contenga
    la directiva ng-include, reemplazando lo que tuviera previamente ese
    elemento

    Imaginemos que extraemos el siguiente trozo de HTML a un archivo llamado
    stock.html
-->
<!-- File: chapter11/ng-include/stock.html -->
<div class="stock-dash">
  Name:
<span class="stock-name"
      ng-bind="stock.name">
</span>
  Price:
<span class="stock-price"
      ng-bind="stock.price | currency">
</span>
  Percentage Change:
<span class="stock-change"
      ng-bind="mainCtrl.getChange(stock) + '%'">
</span>
</div>

<!-- Así sería la pagina principal de la aplicacion. index.html -->
<!-- File: chapter11/ng-include/index.html -->
<html>
<head>
  <title>Stock Market App</title>
</head>
<body ng-app="stockMarketApp">

<div ng-controller="MainCtrl as mainCtrl">
  <h3>List of Stocks</h3>

  <div ng-repeat="stock in mainCtrl.stocks">
    <div ng-include="mainCtrl.stockTemplate">
    </div>
  </div>

</div>

<script src="http://code.angularjs.org/1.2.16/angular.js"></script>
<script src="app.js"></script>

</body>
</html>

<!--
  Vemos que el partial corresponde a la parte que se repite con ng-repeat
  En este caso hacemos que la ruta a la que apunta ng-include se define en el
  controlador, pero podriamos haberlo definido inline con un string

    <div ng-include="'views/stock.html'"></div>

  Observa también que el string está entre comillas simples, esto es para que
  AngularJS sepa que lo que le pasamos es un string literal, no una variable,
  sin las comillas simples dentro de las dobles interaría buscar la variable
  view/stock.html  lo cual evidentemente fallaría.

  El modulo de nuestra aplicación sería el siguiente. Estaría en el archiv
  app.js (sin <script> evidentemente)
-->
<script>
  // File: chapter11/ng-include/app.js
  angular.module('stockMarketApp', [])
    .controller('MainCtrl', [function () {
      var mainCtrl           = this;
      mainCtrl.stocks        = [
        {name: 'First Stock', price: 100, previous: 220},
        {name: 'Second Stock', price: 140, previous: 120},
        {name: 'Third Stock', price: 110, previous: 110},
        {name: 'Fourth Stock', price: 400, previous: 420}
      ];
      mainCtrl.stockTemplate = 'stock.html';
      mainCtrl.getChange     = function (stock) {
        return Math.ceil((
          (stock.price - stock.previous) / stock.previous) * 100);
      };
    }]);

/*
*   Siempre que queramos servir un partial, debemos hacerlo desde servidor ya
*   que el navegador no permite pedir archivos con el protocolo file://
*   De forma simple podemos añadir un servidor con el modulo htt-server
*
*     sudo npm install -g http-server
*
*   y despues ejecutarlo en el directorio en el que esté index.html
*
*     http-server
*
*   Webstorm tambien crea un servidor si ejecutamos index.html con él.
* */
</script>

<!--
  Limites de ng-include
    - El archivo stock.html busca una variable llamada stock para mostrar el
      nombre, precio y porcentaje
      Esto significa que si cambiamos el nombre en uno si y en otro no la
      aplciacion no funcionará, por lo que tenemos que mantener dos archivos
      en vez de uno.
    - El partial no es reusable pues depende de un controlador y del propio
      archivo index.html que define el nombre sobre el que se va a iterar.
    - Estos problemas se pueden solucionar con directivas creadas por nosotros
      o custom directives
-->
